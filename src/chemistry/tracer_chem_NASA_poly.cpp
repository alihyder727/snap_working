/** @file tracer_chem_NASA_poly.cpp
 * @brief
 *
 * @author Ali Hyder (ali.hyder@jpl.nasa.gov)
 * @date Monday 09/06/2025
 * @bug Still testing!!!
 */


#include "tracer_chem_NASA_poly.hpp"
#include <stdexcept>
#include <cfloat>

namespace NASA_POLY {

// Use an array since Species is an enum class with dense values
static const std::array<NASACoeffPair, 12> species_data = {{
    // CO
    {
        {-8.12674056e+04, 1.44584303e+03, -8.48882019e+00,
        3.60377848e-02, -8.72224514e-05, 9.84235413e-08,
        -4.22141668e-11, -2.02794511e+04, 5.58505087e+01},
        {6.45288795e+05, -5.20591633e+02, -1.94199375e+00,
        2.28448402e-03, -1.59490759e-06, 4.77375195e-10, 
        -5.61346232e-14, -8.00533100e+03, 2.22041168e+01},
        1000.0
    },
    // CH4
    {
        {-3.71537240e+05,  6.36843991e+03, -4.21090244e+01,
        1.10931447e-01, -1.73395947e-04,  1.52615054e-07, 
        -5.64354811e-11, -3.76219727e+04, 2.22877252e+02},
        {2.27281672e+06, -9.56418553e+03,  7.59149994e+00, 
        -9.81636909e-04,-6.23317903e-07,  3.49499945e-10, 
        -4.86686647e-14,  5.06568957e+04, -7.27351090e+01},
        1000.0
    },
    // H2O
    {
        {-6.31350233e+04,  1.13414166e+03, -7.84242484e+00,
        1.77729128e-02, -2.45367931e-05,  1.79953325e-08, 
        -5.22454675e-12, -3.40265003e+04, 3.84314488e+01},
        {9.93128806e+05, -2.74796323e+03,  7.60880232e-01,
        4.05825396e-04, -2.00208030e-07,  2.46298394e-11, 
        -8.05713078e-16, -1.07376349e+04, -1.44689563e+01},
        1000.0
    },
    // H3PO4 - NASA7 Polynomials from BURCAT for PH3 Equilibrium (unprimed - use carefully; for G(T))
    {
        {-1.82480022E+00, 6.92983740E-02, -1.01448758E-04, 
        6.91910155E-08, -1.77690951E-11, -1.36317149E+05, 
        3.30354162E+01},
        {1.38520189E+01, 4.93643885E-03, -1.55822515E-06, 
        2.29340638E-10, -1.28366239E-14, -1.39420678E+05, 
        -4.22913846E+01},
        1000.0
    },
    // H2O_N7
    {
        {4.198640560E+00,  -2.036434100E-03, 6.520402110E-06,   
        -5.487970620E-09,   1.771978170E-12, -3.029372670E+04, 
        -8.490322080E-01},
        { 3.033992490E+00,   2.176918040E-03, -1.640725180E-07,
        -9.704198700E-11,  1.682009920E-14, -3.000429710E+04, 
        4.966770100E+00},
        1000.0
    },
    // H2
    {
        {2.344331120E+00,   7.980520750E-03, -1.947815100E-05, 
        2.015720940E-08,  -7.376117610E-12, -9.179351730E+02, 
        6.830102380E-01},
        {3.337279200E+00,  -4.940247310E-05, 4.994567780E-07, 
        -1.795663940E-10,   2.002553760E-14, -9.501589220E+02, 
        -3.205023310E+00},
        1000.0
    },
    // H - Additional NASA7 polynomials from BURCAT for PH3 timescale
    {
        {2.500000000E+00,   7.053328190E-13, -1.995919640E-15,
        2.300816320E-18,  -9.277323320E-22, 2.547365990E+04,  
        -4.466828530E-01},
        {2.500000010E+00,  -2.308429730E-11, 1.615619480E-14,
        -4.735152350E-18,   4.981973570E-22, 2.547365990E+04, 
        -4.466829140E-01},
        1000.0
    },
    // PO2
    {
        {3.70338274E+00, 1.99856635E-03, 8.62444075E-06, 
        -1.34479846E-08, 5.58470721E-12, -3.51050019E+04, 
        8.53959173E+00},
        {5.27587261E+00, 1.80638038E-03, -7.50028350E-07, 
        1.40062873E-10, -9.17506743E-15, -3.57348111E+04,
        -5.74241509E-01},
        1000.0
    },
    // HOPO2
    {
        {1.63070941E+00, 2.49990293E-02, -2.23292246E-05, 
        5.83782168E-09, 1.06880806E-12, -8.72608520E+04, 
        1.81667382E+01},
        {9.07543004E+00, 3.08252827E-03, -1.12339846E-06, 
        1.83697534E-10, -1.11135239E-14, -8.91864155E+04,
        -1.97912936E+01 },
        1000.0
    },
    // GeH4
    {
        {2.54992789E+00, 7.13885765E-03, 1.43758337E-05,
        -2.33592977E-08, 9.65676013E-12, 9.69756465E+03, 9.02678812E+00},
        {5.41474159E+00, 7.24155154E-03, -2.71818301E-06,
        4.51535021E-10, -2.75635275E-14, 8.46356611E+03, -7.83419271E+00},
        1000.0
    },
    // GeH2
    {
        {3.7506863639539256, 0.0012245935111650902, 3.0583823228765663e-06, 
        -2.6215501966870634e-09, 4.773981941350087e-13, 28813.05596993913,
        6.315204425285269},
        {3.7506863639539256, 0.0012245935111650902, 3.0583823228765663e-06, 
        -2.6215501966870634e-09, 4.773981941350087e-13, 28813.05596993913,
        6.315204425285269},
        1000.0
    },
    // PH3
    {
        {4.17009763E+00, -5.06487157E-03, 2.86027846E-05,  
        -3.13123782E-08, 1.13447768E-11, 2.03144445E+02,  
        2.02004617E+00},
        {3.71229298E+00, 5.85959002E-03, -2.16607791E-06, 
        3.56195511E-10, -2.15913467E-14, -1.88863997E+02, 
        1.92781913E+00},
        1000.0
    }
}};

// === Define the raw data ===

// NASA-9 polynomials to be treated as globals for CO (for deltaG(T)):


// NASA7 Polynomials from BURCAT for PH3 Equilibrium (unprimed - use carefully; for G(T)):


// === Selector ===

const std::vector<double>& GetCoefficients(Species sp, double T) {
    std::size_t idx = static_cast<std::size_t>(sp);
    const NASACoeffPair& coeff = species_data[idx];
    return (T < coeff.T_mid) ? coeff.low : coeff.high;
}

} // namespace NASA_POLY
